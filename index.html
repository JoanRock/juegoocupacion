<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Juego de Ocupación Simplificado</title>
  <style>
    body { display: flex; flex-direction: column; align-items: center; font-family: sans-serif; background: #f0f0f0; margin:0; padding:20px; }
    h1 { margin-bottom:10px; }
    #status { margin-bottom:10px; font-weight:bold; }
    #board { display: grid; grid-template: repeat(8, 60px) / repeat(8, 60px); gap:2px; }
    .cell { background: #fff; border:1px solid #999; display:flex; justify-content:center; align-items:center; cursor:pointer; position:relative; }
    .cell.dark { background: #ddd; }
    .trail { position:absolute; width:20px; height:20px; border-radius:50%; opacity:0.6; }
    .token { font-size:32px; line-height:1; }
    .trail-0 { background:rgba(255,0,0,0.6); }
    .trail-1 { background:rgba(0,128,0,0.6); }
    .trail-2 { background:rgba(0,0,255,0.6); }
    .trail-3 { background:rgba(255,165,0,0.6); }
    .token-0 { color:#f00; }
    .token-1 { color:#080; }
    .token-2 { color:#00f; }
    .token-3 { color:#fa0; }
    #scores { display: flex; gap:15px; margin-top:10px; }
    .score { display:flex; align-items:center; gap:4px; }
  </style>
</head>
<body>
  <h1>Juego de Ocupación</h1>
  <div id="status">Turno: Jugador 1</div>
  <div id="board"></div>
  <div id="scores"></div>

  <script>
    const SIZE=8;
    const boardEl=document.getElementById('board');
    const statusEl=document.getElementById('status');
    const scoresEl=document.getElementById('scores');

    // Estado
    let turn=0;
    const pieces={ '0,0':0, '7,7':1, '0,7':2, '7,0':3 };
    const trails={};

    let selected=null;

    // Inicializar tablero
    for(let r=0;r<SIZE;r++){
      for(let c=0;c<SIZE;c++){
        const cell=document.createElement('div');
        cell.className='cell '+((r+c)%2?'dark':'');
        cell.dataset.coord=`${r},${c}`;
        cell.addEventListener('click',()=>onClick(cell));
        boardEl.appendChild(cell);
      }
    }

    function render(){
      // Limpia
      document.querySelectorAll('.cell').forEach(cell=>{
        cell.innerHTML='';
        cell.classList.remove('selected');
      });
      // Dibuja trazas
      for(const k in trails){
        const cell=document.querySelector(`[data-coord='${k}']`);
        if(!cell) continue;
        const dot=document.createElement('div');
        dot.className='trail trail-'+trails[k];
        cell.appendChild(dot);
      }
      // Dibuja fichas
      for(const k in pieces){
        const cell=document.querySelector(`[data-coord='${k}']`);
        if(!cell) continue;
        const span=document.createElement('span');
        span.className='token token-'+pieces[k];
        span.textContent='♟';
        cell.appendChild(span);
      }
      // Actualiza estado
      statusEl.textContent=`Turno: Jugador ${turn+1}`;
      // Puntajes
      const counts=[0,0,0,0];
      for(const k in trails) counts[trails[k]]++;
      scoresEl.innerHTML = counts.map((v,i)=>
        `<div class="score"><div class="dot" style="background:${['#f00','#080','#00f','#fa0'][i]}"></div>J${i+1}: ${v}</div>`
      ).join('');
    }

    function onClick(cell){
      const coord=cell.dataset.coord;
      if(selected===null){
        // seleccionar ficha propia
        if(pieces[coord]===turn){
          selected=coord;
          cell.classList.add('selected');
        }
      } else {
        // mover
        const [sr,sc]=selected.split(',').map(Number);
        const [dr,dc]=coord.split(',').map(Number);
        const dR=Math.abs(dr-sr), dC=Math.abs(dc-sc);
        if((dR<=1&&dC<=1&&(dR+dC>0))){
          // deja traza
          trails[selected]=turn;
          // captura
          if(pieces[coord]!=null&&pieces[coord]!==turn) delete pieces[coord];
          // mueve
          delete pieces[selected];
          pieces[coord]=turn;
          // elimina rodeados
          eliminate();
          // siguiente turno
          turn=(turn+1)%4;
        }
        selected=null;
      }
      render();
    }

    function eliminate(){
      for(const k in {...pieces}){
        const [r,c]=k.split(',').map(Number);
        let surrounded=true;
        for(let dr=-1;dr<=1;dr++){
          for(let dc=-1;dc<=1;dc++){
            if(dr===0&&dc===0) continue;
            const nr=r+dr, nc=c+dc;
            const key=`${nr},${nc}`;
            if(nr<0||nc<0||nr>=SIZE||nc>=SIZE){ surrounded=false; break; }
            if(!(pieces[key]!=null||trails[key]!=null)){ surrounded=false; break; }
          }
          if(!surrounded) break;
        }
        if(surrounded) delete pieces[k];
      }
    }

    // Inicia
    render();
  </script>
</body>
</html>
